# 计算机网络

---

---

---

## 1.1 什么是Internet

> 有两种方式描述什么是因特网，一个是它的软件组成与硬件组成，另一个是根据 为分布式应用提供服务的联网基础设施来描述因特网，我们先从前者开始进行描述

### 1.1.1 具体组成

所有与因特网相连接的设备，例如过去的Linux或者是Windows的电脑服务器，还是现在的物联网设备，都统一称为**主机**或者**端系统**

端系统之间通过**通信链路**与**分组交换机**连接。

- 通信链路由不同类型的实体（同轴电缆、铜线、光纤和无线电频谱）组成，不同的链路能实现不同的传输速率，可以将其类比于高速公路和公路，不同地路段限速、可行驶地速度都有所不同

- 了解什么是分组交换机，首先得了解什么是**分组**。分组就是把数据分段，并做一定的标记（每段加上首字节）。而分组交换机就是从**入**通信链路接收数据，按组分发给**出**通信链路，整个过程更像是快递中的快递站点，从北京上海收集到包裹，然后分发到广州深圳。分组交换机中比较著名的是路由器和链路层交换机，前者用于接入网中，后者用于网络核心中

>  从发送端到接收端，一个分组经历的一系列的通信链路和分组交换机称为通过该网络的**路径**。

端系统通过**因特网服务提供商（简称ISP）**接入因特网（类似于中国电信中国移动这些），这些ISP由 多个分组交换机 和 多个通信链路 构成的网络 组成的，换句话说，这些XX快递是由物流网络组成的。由于因特网就是将端系统之间互联，因此为它们提供服务的ISP也必须是互联的

---

### 1.1.2 从服务描述

>  从 为 应用程序 提供服务的 基础设施的角度来描述

这里的应用程序就是指的手机电脑上那些要联网的游戏啊服务之类的，它们一般用编程语言编写，并通过分组交换机与另一个端主机进行交换数据，又被称为 分布式应用程序。它们运行在端系统上而不是在分组交换机上，并于多台端主机进行交换数据。

端系统为应用程序提供了**应用程序编程接口（即API）**，api规定了一台主机向另一台主机发送特定数据的方式，它是一套发送软件必须遵循的规矩集成，这就好比入投递邮件时，要按照一个的规则写好邮政编码等等，这样邮政才能将信件送达给对方

---

### 1.1.3 什么是协议

端系统、分组交换机和其他网络设备收发信息都需要遵从一定的**协议**，这些协议控制着因特网中信息接收与发送。TCP（传输控制协议）与IP（网际协议）是因特网中最重要的两个协议，IP协议定义了路由器与端之间收发分组的格式

从一个例子更好理解协议是什么。课堂上有听课和不听课的人，老师请同学们举手回答问题，即老师向同学们发出通信请求；同学举手则代表该同学接受请求；同学回答问题则是同学发出信息，老师听到这个回答并做出反应便是一个接受信息。在这个过程中，规范地通信就是指，同学举手了老师才能点他起来回答问题；而通信请求与回复则是老师鼓励同学们回答而同学们举手；当然也有拒绝通信的（比如睡着的）。这个也可以与打招呼类比，对方回应了你的招呼代表他可以与你进行交流，没回应或者做出其他不好的回应则是不想进行交流。

网络中的协议类似于我们人类中的协议。比如我们在连接网页的时候，它往往是这样的：浏览器向网址端发送请求，网址端接收请求并回答请求

，浏览器再获取所要的网页的名字，而网址端则把网页返回给浏览器

因此，我们可以总结一下，**协议就是收发信息以及其过程采取的一系列规定的动作**

---

---

## 1.2 网络边缘

通常把与因特网相连接的计算机与其他设备称为端主机，因为它们处于因特网的边缘，所以被称为端系统。

主机等于端系统，而主机又分为两类，客户与服务器。

---

### 1.2.1 接入网

**接入网**是指将端系统连接到**边缘路由器**的物理链路，而边缘路由器则是端主机到其他任何远程端主机的路径的第一台路由器

1. 家庭中的接入网

   **数字用户线（DSL）**和电缆是当今最常见的宽带住宅接入形式。用户通常通过本地电话公司获取DSL因特网接入，当使用DSL时，用户的本地电话公司也是它的ISP。每个用户的**DSL调制解调器**通过现有的电话线与本地电话公司的**本地中心局（CO）**的**数字用户线接入复用**（DSLAM）来交换数据

   **电缆因特网接入**是在有线电视的基础上实现的。如图所示，光缆将电缆头端连接到地区枢纽，并使用同轴电缆传输给家庭<img src="C:\Users\32620\AppData\Roaming\Typora\typora-user-images\image-20230429151341145.png" alt="image-20230429151341145" style="zoom:50%;" />这种接入需要电缆调制解调器。与之对应的是电缆调职解调器的端接系统（CMTS），它在电缆头段起到与DSLAM一样的作用，即将家庭中发出的模拟信号转为数据信号。电缆因特网接入的重要特征是共享广播媒体，即如果每个用户同时经过下行信道下载一个视频文件，那么下载速率大大降低；另一方面，如果仅有很少用户同时访问一个Web，则每个用户都将享受最高速率。	

   **FTTH光纤到户**技术可以以更高速率进行传输。直接光纤，即从本地中心局到每户设置一条光纤。

   被动光纤网络（PON），<img src="C:\Users\32620\AppData\Roaming\Typora\typora-user-images\image-20230429152414078.png" alt="image-20230429152414078" style="zoom:50%;" />

2. 企业与家庭接入：以太网与WIFI

   以太网是目前为止最流行的接入技术，在无线LAN环境中，用户通过接入点进行收发分组，该接入点与企业网相连接。这是一个简单的家用网络接入<img src="C:\Users\32620\AppData\Roaming\Typora\typora-user-images\image-20230429155435745.png" alt="image-20230429155435745" style="zoom:50%;" />，它分别由，一个i提供接入的电缆调制解调器（用于提供接入）、一台漫游便携机、和一台有线pc，还有一个与无线PC通信的基站。

3. 广域无线接入：3G与LTE<img src="C:\Users\32620\AppData\Roaming\Typora\typora-user-images\image-20230429155709672.png" alt="image-20230429155709672" style="zoom:50%;" />（不是怎么才3G。。）

---

### 1.2.2 物理媒体

对于每个传输器和接收器，它们是通过实际的物理媒介进行传播数据的。

物理媒体可以划分为两类，第一类是导型媒体，电波沿固型媒体前行，如光缆和铜线；对于非导型媒体，电波沿着空气或者外层空气传播，比如卫星信号等

- 双绞铜线

  最便宜且使用最广泛的导引型传输媒体，它有两根隔离铜线组成，并以规则螺旋形是缠绕，一对电线构成一个通信链路。传输速率取决于线的粗细与距离

- 同轴电缆

  同轴电缆，顾名思义，即两根铜线共用一条轴，即同心而非并行。它能达到较高的数据传输速率，并且在电缆电视系统中相当普遍和常见

- 光纤

  光纤能够支持极高的传输速率，并且不容易受到电磁干扰，也很难窃听。遗憾的是搭建光设备成本过高，因此经常用来长途传输远程数据

- 陆地无线电信道

  它不需要安装物理线路，并且具有穿透墙壁，提供连接以及长时间承受信号的能力。它极大依赖于传播环境与传播距离。无线LAN与蜂窝技术正是使用了无线电信道技术。

- 卫星无线电信道

  通信卫星连接地面多个地面站进行信息的收发。该卫星在一个频道上接受信息，并通过转发器，再生信号，然后再另一个频道上传输信号。

---

---

## 1.3 网络核心

分组交换机和链路构成的网状网络即是我们这里要讨论的网络核心。

### 1.3.1分组交换

首先了解几个概念

报文：报文可以执行一些操作的功能，也可以是数据。

分组：源主机向目标主机发送长报文时，将长报文分割为较小的数据块，称之为分组。在源和端之间，每个分组通过路径传送。分组以等于该链路最大传输速率的速度传输通过通信链路。因此，如果某源端系统或分组交换机经过一条链路发送一一个L比特的分组，链路的传输速率为R比特/秒，则传输该分组的时间为L/R秒。

- 存储转发传输

  多数分组交换机在链路的输入端使用的是存储转发传输，即交换机必须接收到整个分组，才能开始向输出端发出分组。

- 排队时延和分组丢失

  每个分组交换机有多条链路与之相连。对于每条相连的链路，该分组交换机具有一个**输出队列**。该输出队列在分组交换中起着重要的作用。如果到达的分组需要传输到某条链路，但发现该链路**正忙于传输其他分组**，该到达分组必须**在该输出缓存中等待**。因此，除了**存储转发时延**以外，分组还要承受**输出缓存的排队时延**。这些时延是变化的，变化的程度取决于网络中的拥塞程度。因为缓存空间的大小是有限的，一个到达的分组可能发现**该缓存已被其他等待传输的分组完全充满了**。在此情况下，将出现分组丢失(**丢包**)，到达的分组或已经排队的分组之一将被丢弃。

- 转发表与路由选择协议
  在因特网中，每个端系统具有一个称为**IP地址**的地址。当 源主机 要向 目的端系统 发送一个 分组 时，源在该分组的首部包含了**目的地的IP地址 **。如同邮政地址那样，该地址具有一种**等级结构**。当一个分组到达网络中的路由器时，路由器检查该分组的**目的地址的部分**，并向一台相邻路由器转发该分组。

  更特别的是，每台路由器具有一个**转发表**，为 将目的地址 传送到 对应的输出链 作为对找。当某分组到达一台路由器时，路由器检查该地址，**并用这个目的地址搜索其转发表**，以发现适当的出链路。路由器则将分组导向该出链路。

---

### 1.3.2 电路交换

在电路交换网络中，在端系统间通信会话期间，预留了端系统间通信沿路径所需要的资源(缓存，**链路传输速率**)。在分组交换网络中，这些资源则不是预留的.

一个简单的类比是，考虑两家餐馆，电路家需要顾客预订，而分组家不需要预订但不保证能安排顾客。电路家预定的时候比较麻烦，但是在需要用的时候确实可以快速入座；分组家不用预定，但很可能去到之后要进行排队。

传统的电话网络是电路交换网络的例子。当一个人准备通过电话网给另一个人发送信息之前，它们会先建立起一条连接。用电话的术语来说，该连接被称为一条电路。当网络创建这种电路时，它也在连接期间在该网络链路上预留了**恒定的传输速率(表示为每条链路传输容量的一部分)**。既然已经为该发送方-接收方连接预留了带宽，则发送方能够以确保的恒定速率向接收方传送数据。

如图，链路由4条电路组成，对于端到端的连接，它们会预留出1/4的电路负责传输，即连接期间获得链路带宽的1/4<img src="C:\Users\32620\AppData\Roaming\Typora\typora-user-images\image-20230429173827067.png" alt="image-20230429173827067" style="zoom:50%;" />

####  - 1. 电路交换网络中的复用

1.电路交换网络中的复用链路中的电路是通过频分复用（FDM）或时分复用（TDM)来实现的。

对于FDM,链路的频谱由跨越链路创建的所有连接所共享。特别是，在连接期间链路为每条连接专用一一个频段。在电话网络中，这个频段通常具有4kHz的宽度(即4000赫兹或每秒4000周)。

对于一条TDM链路，时间被划分为固定区间的帧，并且每帧又被划分为固定数量的时隙。当网络跨越一条链路创建一条连接时， 网络在每个帧中为该连接指定一个时隙。这些时隙专门由该连接单独使用，一个时隙(在每个帧内)可用于传输该连接的数据。<img src="C:\Users\32620\AppData\Roaming\Typora\typora-user-images\image-20230429231705197.png" alt="image-20230429231705197" style="zoom:80%;" />

对于FDM，每条电路持续获得部分宽带；对于TDM，每条电路间断性获得全部宽带

即假设有四条电路，那么FDM中每条电路速度为最大速度1/4，而TDM中每条电路轮流获得最大速度。

#### - 2. 分组交换与电路交换的对比

分组交换的性能能够优于电路交换的性能。电路交换不考虑需求，而预先分配了传输链路的使用，这使得**已分配而并不需要的链路时间未被利用**。另一方面，分组交换按需分配链路使用。链路传输能力将在所有用户之间逐分组地被共享，这些用户有分组需要在链路上传输。
虽然分组交换和电路交换在今天的电信网络中都是普遍采用的方式，但趋势无疑是朝着分组交换方向发展。甚至许多今天的电路交换电话网正在缓慢地向分组交换迁移。特别是，电话网经常在昂贵的海外电话部分使用分组交换。

---

### 1.3.3 网络的网络

网络结构1：用单一的全球承载ISP互联所有接入的ISP。由于成本巨大，因此全球承载ISP会向所有接入的ISP要求付费

网络结构2：巨大的利润驱使其他公司建立全球承载ISP，这导致了网络结构2，它由数十万个接入ISP与多个全球承载ISP构成，这些全球承载ISP必须是互联的

网络结构3：引入区域ISP概念，即多层ISP。网络结构2是只有两层ISP，而网络结构3有多层ISP，其中顶层即为全球承载ISP。并且公司们不仅在顶层ISP存在竞争，在区域的ISP也存在竞争。

网络结构4：在3的基础上加上点（Pop）、多宿、对等和因特网交换点（Ixp）。PoP存在于等级结构的所有层次，但底层(接人ISP)等级除外。一个PoP只是提供商网络中的一台或多台路由器(在相同位置)群组。任何ISP可以和两个以上的ISP供应商连接，这就是多宿。对等是指同一级的ISP之间不互相付费。这样就形成了网络结构4的生态系统，由接人 ISP、区域ISP第一层ISP、PoP、多宿、对等和IXP组成，这个系统作为网络结构4。

网络结构5：在网络结构4的顶部添加了 **内容供应商网络**<img src="C:\Users\32620\AppData\Roaming\Typora\typora-user-images\image-20230430093508006.png" alt="image-20230430093508006" style="zoom:55%;" />

---

---

## 1.4 分组交换网中的时延、丢包和吞吐量

### 1.4.1 分组交换网中的时延概述

前面讲过，分组从一台主机(源)出发，通过一-系列路由器传输，在另一台主机(目的地)中结束它的历程。当分组从一个结点(主机或路由器)沿着这条路径到后继结点(主机或路由器)，该分组在沿途的每个结点经受了几种不同类型的时延。

这些时延最为重要的是结点处理时延、排队时延、传输时延和传播时延，这些时延总体系加起来是结点总时延。许多因特网应用，如搜索、Web 浏览、电子邮件、地图、即时讯，它们的性能受网络延迟的影响都很大。·

**时延的几种类型**

- 处理时延

  **检查分组首部和决定将该分组导向何处**所需要的时间是处理时延的一部分。处理时延也能包括其他因素，如**检查比特级别的差错**所需要的时间，该差错出现在从上游结点向路。在这种结点处理之后，路由器将该分组引向通往路由器B链路之前的队列。

- 排队时延

  在队列中，当分组在链路上等待传输时，它经受排队时延。一个特定 分组的排队时延长度将取决于先期到达的正在排队等待向链路传输的分组数量。实际的排队时延可以是毫秒到微秒量级。

- 传输时延

  从链路的起点到目标路由器传播所需要的时间是传播时延。该比特以该链路的传播速率传播。该传播速率取决于该链路的物理媒体(即光纤、双绞铜线等)。该传播时延等于两台路由器之间的距离除以传播速率。即传播时延是d/s,其中d是路由器A和路由器B之间的距离，s是该链路的传播速率。在广域网中，传播时延为毫秒量级。

- 传输时延

  传输时延是路由器将分组推出所需要的时间，它是分组长度和链路传输速率的函数，而与两台路由器之间的距离无关。以释放压缩着弹簧的木块为例，传输时延是弹簧从被压缩状态恢复至原长度状态，而传播时延则是木块运动到A点的时间。

---

### 1.4.2 排队时延和丢包

**排队时延**

结点时延中最为复杂的是**排队时延**。排队时延对不同分组来说是不同的，人们通常使用统计量测度，比如平均排队时延，排队时延的方差和排队时延的频率。

排队时延的大小取决于流量到达该队列的速率、链路的传输速率和到达的流量的性质（流量是周期性到达还是突发性到达）。

我们设a为分组到达队列的速率，每个分组都是由L个比特组成的（假设），而队列中比特流出的速率为R，则比率流量强度La/R。

当流量强度大于1时，代表排队时延会不停增大，甚至是无限大（堆积起来了，最后不停的累计累计）

当流量强调小于1时，流量到达的性质就会影响速率。分组如果是周期性到达，那么都不用排队，但如果是突发性到达，就得排队。

**丢包**

上面的情况是基于队列容量无限大的，	然而实际中，一条链路只有有限的容量。到达的分组发现队列是满的，但是又没有地方存放该分组，那么路由就会舍弃这个分组。

---

### 1.4.3 端到端时延

现在考虑源到目的地的总时延，假定源主机与目标主机之间有N-1台路由设备，并且此时网络没有拥堵。

**1.Traceroute**

这是一个简单的程序，它能在任何因特网的主机上运行。当源主机指定一个目标主机时，则该程序会发送N个特殊分组，特殊分组的标识分别是由1到N。当第N台路由收到标识为N的第N个分组时（比如第1台收到表示为1个分组，第5台~），该路由不是向目的地转发分组，而是向源主机传回一个报文。这时候源主机就可以记录这个报文的往返时间以及对应的路由的名字和地址

---

### 1.4.4 计算机网络中的吞吐量

吞吐量可以理解为接收文件的速率，瞬时吞吐量就是瞬时接收一个文件的速率，而平均吞吐量则是（文件比特量）/（接收所用时间）

为了更好理解吞吐量，假使服务器与客户之间存在两条通信链路和一个路由器<img src="C:\Users\32620\AppData\Roaming\Typora\typora-user-images\image-20230430111109405.png" alt="image-20230430111109405" style="zoom:50%;" />，那么视从服务器到路由器的通信链路为水管R1，客户到路由器的通信链路为水管R2，则吞吐量的是 R1和R2中最小的那个传输速率。	换句话说，它是瓶颈链路的传输速率。为什么这么说呢？

假使有两根半径不同的水管连接在一起，那么从大的水管给小的水管通水，小的水管终点处接收水的速率是小的水管的速率，因为你大的水管再大，小的水管也就只能容纳这么多，因此这里速率取决于小的水管。

如果从小的水管通水，大的水管的终点接收。由于小的水管就通这么多水而已，所以在大水管内实际水流的大小还是小的水管的大小。

而一般来说，服务器是大的水管，它要接收许多小水管传过来的水。即接入方（用户）往往是限制者。

---

---

## 1.5 协议层次极其服务模型

### 1.5.1 分层的体系结构

由于计算机网络的各个功能和部分相互交织，十分复杂，采用分层的体系结构能够使系统结构化、模板化，从而更方便地更新系统

**什么是分层**

对一些功能划分层次，每个层次通过以下方式提供服务：在这层中执行某些动作；直接使用下层的服务；或前两者结合使用<img src="C:\Users\32620\AppData\Roaming\Typora\typora-user-images\image-20230430155222233.png" alt="image-20230430155222233" style="zoom:50%;" />

便于更新是因为，该层对其上面的层提供相同的服务，并目使用来自下面层次的相同服务，当某层的实现变化时，该系统的其余部分保持不变。例如，如果登机口功能被改变了(例如让人们按身高登机和离机)，航线系统的其余部分将保持不变，因为**登机口仍然提供相同的功能**(人们登机和离机);改变后，它仅是以不同的方式实现了该功能。对于大而复杂且需要不断更新的系统，改变服务的实现而不影响该系统其他组件是分层的另一个重要优点。

**协议分层**（协议栈）

![image-20230430155735389](C:\Users\32620\AppData\Roaming\Typora\typora-user-images\image-20230430155735389.png)

网络设计者以分层的方式组织协议以及实现这些协议的网络硬件和软件。每个协议属于这些层次之一。

我们再次关注某层向它的上层提供的服务， 即每层通过在该层中执行某些动作或使用直接下层的服务来提供服务。例如，由第n层提供的服务可能包括报文从网络的一边到另一边的可靠传送。这可能是通过使用第n-1层的边缘到边缘的不可靠报文传送服务，加上第n层的检测和重传丢失报文的功能来实现的。

一个协议层能够用软件、硬件或两者的结合来实现。诸如HTTP和SMTP这样的**应用层**协议几乎总是在端系统中用软件实现的，**运输层**协议也是如此。因为**物理层**和数据链路层负责处理跨越特定链路的通信，它们通常是实现在与给定链路相联系的网络接口卡(例如以太网或WiFi接口卡)中。**网络层**经常是硬件和软件实现的混合体。还要注意的是，如同分层的航线体系结构中的功能分布在构成该系统的各机场和飞行控制中心中一样，**一个第n层协议也分布在构成该网络的端系统、分组交换机和其他组件中**。这就是说，**第n层协议的不同部分常常位于这些网络组件的各部分中。**
将这些综合起来，各层的所有协议被称为**协议栈( protocol stack)**。因特网的协议栈由5个层次组成:物理层、链路层、网络层、运输层和应用层(如图1-23a所示)。我们采用了**自顶向下方法**( ton- down anproach)。首先处理应用层，然后向下进行处理。

- 应用层
  应用层是网络应用程序及它们的应用层协议存留的地方。因特网的应用层包括许多协议，例如HTTP (它提供了Web文档的请求和传送)，SMTP(它提供了电子邮件报文的传输)和FTP (它提供两个端系统之间的文件传送)
  一些网络地址网络地址，也是借助于特定的**应用层协议**即**域名系统(DNS)**完成的。

  一个端系统的应用程序使用协议与另一个端系统的应用程序 交换信息的分组，我们把这种位于**应用层的信息分组**称为**报文**	

- 运输层

  因特网的运输层在**应用程序端点之间**传送**应用层报文**。在因特网中，有两个运输协议，即**TCP和UDP**,利用其中的任一个都能运输应用层报文。

  TCP向它的应用程序提供了面向连接的服务。这种服务包括了应用层报文向目的地的确保传递和流量控制(即发送方/接收方速率匹配)。TCP也将长报文划分为短报文，并提供拥塞控制机制，因此当网络拥塞时，源抑制其传输速率。（TCP比UDP慢，但是稳）

  UDP协议向它的应用程序提供无连接服务。这是一种不提供不必要服务的服务，没有可靠性，没有流量控制，也没有拥塞控制。在本书中，我们把**运输层分组**称为**报文段**( segment)。（UDP可靠性不如TCP，但是快）

- 网络层

  因特网的网络层负责将称为**数据报**的**网络层分组**从一台主机移动到另一台主机。在一台源主机中的因特网运输层协议(TCP或UDP)向 网络层 递交 运输层报文段（就是运输层分组）和目的地址，就像你通过邮政服务寄信件时提供个且的地址一样。*（大概就是，执行运输层的过程中使用的协议会向网络层汇报情况）*

  因特网的网络层包括著名的**IP协议**，该协议定义了在**数据报**中的**各个字段以及端系统和路由器如何作用于这些字段**。仅有一个IP协议，所有具有网络层的因特网组件必须运行IP协议。

  因特网的网络层也包括**决定路由的路由选择协议**，它使得数据报根据该路由从源传输到目的地。因特网具有许多路由选择协议，其网络管理者能够运行所希望的任何路由选择协议。

  尽管网络层包括了IP协议和一些路由选择协议，但通常把它简单地称为**IP层**，这反映了**IP是将因特网连接在一起的粘合剂这样的事实**。

- 链路层

  为了将分组从一个结点(主机或路由器)移动到路径上的下一个结点，**网络层必须依靠该链路层的服务**。特别是在每个结点，网络层将数据报下传给链路层，链路层沿着路径将数据报传递给下一一个结点。在下个结点，链路层将数据报上传给网络层。

  **由链路层提供的服务取决于应用于该链路的特定链路层协议**。例如，某些协议基于链路提供可靠传递，从**传输结点跨越一条链路到接收结点**。值得注意的是，这种可靠的传递服务不同于TCP的可靠传递服务，TCP 提供从**一个端系统到另一个端系统**的可靠交付。链路层的例子包括以太网、WiFi 和电缆接人网的DOCSIS协议。因为数据报从源到目的地传送通常需要经过几条链路，**一个数据报可能被沿途不同链路上的不同链路层协议处理**。例如，一个数据报可能被一段链路上的以太网和下一段链路上的PPP所处理。网络层将受到来自每个不同的链路层协议的不同服务。在本书中，我们把**链路层分组**称为帧。

- 物理层

  链路层的任务是将整个帧从一个网络元素移动到邻近的网络元素，而物理层的任务是将该帧中的一个一个比特从一个结点移动到下一个结点。

  在这层中的协议仍然是链路相关的，并且进一步与该链路(例如，双绞铜线、单模光纤)的实际传输媒体相关。例如，以太网具有许多物理层协议:一个是关于双绞铜线的，另一个是关于同轴电缆的，还有一个是关于光纤的，等等。在每种场合中，跨越这些链路移动.一个比特是以不同的方式进行的。

---

### 1.5.2 封装

如果看1.5.1有点云里雾里，那么看了这个一定会豁然开朗的

<img src="C:\Users\32620\AppData\Roaming\Typora\typora-user-images\image-20230430164154238.png" alt="image-20230430164154238" style="zoom:67%;" />

首先这是一个数据从源主机传送到目标主机经过的路径，我们会发现，它往往是底层接收信息，传送给高层，由高层处理之后，再通过底层进行传递，而这个各个高层进行处理并逐一下发的过程就是封装（从高层到底层）

链路层交换机实现了第一层和第二层；路由器实现了第一层到第三层。这意味着路由器能够实现IP协议(一种第三层协议)，而链路层交换机则不能。尽管链路层交换机不能识别IP地址，但它们能够识别第二层地址，如以太网地址。

值得注意的是，主机实现了所有5个层次，这与因特网体系结构将它的复杂性放在网络边缘的观点是一致的。

让我们描述以下封装的过程（在最简单的情况下）

1. 应用层报文被传送到运输层。
2. 运输层收取报文并添加上*运输层首部信息*，而*运输层首部信息*与应用层报文的构成了**运输层报文段**

3. 运输层向网络层传递该报文段，而网络层增加*网络层首部信息*（如源和目的端系统地址），从而产生了**网络数据报**，即上面所说的数据报。
4. 该数据报接下来传递给链路层，链路层增加自己的*首部信息*，并创建**链路层帧**（我们把链路层分组叫做帧）

这样一来，我们可以看到，一个分组具有两种类型的字段，首部字段和**有效负载字段**。

---

---

## 1.6 面对攻击的网络

> 时刻将网络安全放在首位

不法分子通过网络传递恶意软件来侵入我们的设备，做各种违法的事情。而我们受害的主机也可能成为类似受害设备网络中的一员，它们统称为僵尸网络。

今天多数的恶意软件是自我复制的，即扩散式地寻找其他主机不断感染。它能够以病毒与蠕虫两种形式进行扩散。

病毒是需要交互式的，它们往往欺诈性的隐藏于可执行的附件上，一旦感染，它很可能会通过端主机向其他主机发送相同的附件。

蠕虫是不需要交互的。如果一个网络应用程序存在漏洞，那么很可能它会从网络中获取信息时接受到蠕虫。

**攻击服务器和网络基础设施**

另一种宽泛类型的安全性威胁称为**拒绝服务攻击（DoS）**DoS攻击使得网络、主机或其他基础设施部分不能由合法用户所使用。Web 服务器、电子邮件服务器、DNS服务器(在第2章中讨论)和机构网络都能够成为DoS攻击的目标。

<img src="C:\Users\32620\AppData\Roaming\Typora\typora-user-images\image-20230430194253066.png" alt="image-20230430194253066" style="zoom:66%;" />

分布式DoS（DDos），攻击者控制多个源让每个源向目标猛烈发送流量

**分组嗅探**

在无线传输设备的附近放置一台被动的接收机，该接收机就能得到传输的每个分组的副本!这些分组包含了各种敏感信息，包括口令、社会保险号、商业秘密和隐秘的个人信息。记录每个流经的分组副本的被动接收机被称为**分组嗅探器( packet sniffer)。**

嗅探器也能布置在有线网络中，比如在以太网中，能获得以太网发送的所有分组。

由于他们时是被动的，即不往信道中注入分组，所以它们的存在难以探测，往往采用密码学的方法进行防御。

**欺诈者**

生成具有任意源地址、分组内容和目的地址的分组，然后将这个人工制作的分组传输到因特网中极为容易
因特网将忠实地将该分组转发到目的地。想象某接收到这样一个分组的不可信的接收方(比如说一台因特网路由器)，将该(虚假的)源地址作为真实的，进而执行某些嵌入在该分组内容中的命令(比如说修改它的转发表)。将具有虚假源地址的分组注人因特网的能力被称为IP哄骗(IP spoofing)，而它只是一个用户能够冒充另一个用户的许多
方式中的一种。
